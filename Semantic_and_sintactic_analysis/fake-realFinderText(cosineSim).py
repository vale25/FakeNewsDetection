#!/usr/bin/python
# -*- coding: iso-8859-15 -*-
import os, sys
import re, math
from collections import Counter
from Variables import *
import ast


#Questa classe calcola in maniera efficiente (circa 4 secondi)
# la realnews corrispondente ad una notizia fake inserita

conta = 0
contatore = 0
cosineSimDict = {}
WORD = re.compile(r'\w+')

def get_cosine(vec1, vec2):
     intersection = set(vec1.keys()) & set(vec2.keys())
     numerator = sum([vec1[x] * vec2[x] for x in intersection])

     sum1 = sum([vec1[x]**2 for x in vec1.keys()])
     sum2 = sum([vec2[x]**2 for x in vec2.keys()])
     denominator = math.sqrt(sum1) * math.sqrt(sum2)

     if not denominator:
        return 0.0
     else:
        return float(numerator) / denominator

def text_to_vector(text):
     words = WORD.findall(text)
     return Counter(words)

#fake = "Politics Former British Prime Minister Tony Blair says UK voters ?have to build the capability to mobilize and to organize? against Brexit. \nFormer British Prime Minister Tony Blair says Britain should keep its ?options open? on whether or not to leave the European Union until after Brexit talks with the bloc are completed. \nDuring an interview on Friday with BBC Radio 4's ?Today? program, Blair described the EU referendum as ?a catastrophe? and said UK voters should be given the option of a second EU referendum. \nBritain should not withdraw from the EU until it becomes clearer how Brexit would impact UK?s economic, social and cultural future, Blair said. \n\"The bizarre thing about this referendum is that we took a decision but we still don't know the precise terms,? he said. ?There?s got to be some way, either through parliament, or through an election, possibly through another referendum, that people express their view.? \nThe former premier, who was in office from 1997 until 2007, said it should be possible for the public to switch their verdict if it becomes clear the alternative negotiated by Prime Minister Theresa May is going to be worse. \nBlair?s argument contrasts sharply with that of May, who has repeatedly said that ?Brexit means Brexit? and that she?ll respect the referendum result. Blair had argued that Britain should stay in the EU before the referendum. \nEconomic growth in the UK is expected to slow significantly next year, due to uncertainty over of the Brexit vote. \nExperts have warned that leaving the EU will severely hurt London?s position as a financial hub, unless the UK decides to keep its access to the single EU market by loosening its stance on immigration. \nIf the UK loses its access to the EU?s single market, the resulting increase in the costs of doing business and exporting to the EU would hurt Britain?s competitive position in Europe. Loading ...".replace('\n', '')
#fake = "(Before It's News)\nIvanka Trump is going to have to back off from her father?s campaign, because the hateful and sexist rhetoric of Donald Trump is severely hurting Ivanka?s clothing and lifestyle brand.\nWomen are turning on Ivanka Trump as she continues supporting her father despite allegations of sexual harassment against him and a 2005 audio tape capturing him bragging in lewd terms that he can do whatever he wants to women.\nNow, the growing group of women are boycotting her line of clothing, jewelry, perfume and accessories sold as part of the Ivanka Trump Collection. They are also calling on the stores that carry the brand, including Nordstrom, Bloomingdale?s and Macy?s, to stop selling it.\nIt has even created its own hashtag, #Ivankant, as well as #GrabYourWallet.\nFrom The Daily Mail :\n?If Ivanka Trump had distanced herself from the campaign I would not be boycotting her,? Shannon Coulter, who called on Americans to boycott the brand earlier this month, told the Guardian.\n?But something changed for me when that tape was released.?\nCoulter, who shared her own experience of sexual harassment at the hands of a male superior, launched the hashtag ?GrabYourWallet? on October 11, a reference to Trump?s offensive ?grab them by the p***y? remark from the audio tape.\nThe problem obviously for Ivanka, is that Donald Trump?s base, for the most part, doesn?t shop at Bloomingdale?s or Nordstrom, which are two of the largest stores that carry her clothing line, along with Macy?s.\nWhat are your thoughts, should Ivanka?s business be hurt because of the actions of her father?\nFrom Politico:\nThe New York Times cited a deposition from a woman who claimed that Donald Trump groped her under the table decades ago, but the presumptive Republican presidential nominee is certainly not a groper, his daughter said Wednesday.\n?Look, I?m not in every interaction my father has, but he?s not a groper,? Ivanka Trump said in an interview broadcast Wednesday on ?CBS This Morning.? ?It?s not who he is. And I?ve known my father obviously my whole life and he has total respect for women.?\nThe billionaire businessman launched a Twitter salvo the ?failing? newspaper for its ?false, malicious & libelous story,? catapulting the story to become the newspaper?s most popular of the year, according to assistant news editor Theodore Kim.\n?\nIvanka Trump said she read the Sunday cover story and ?found it to be pretty disturbing, based on the facts as I know them, and obviously I very much know them? as a daughter and an executive who?s worked alongside him for more than a decade.\n?I was bothered by it, but it?s largely been discredited since,? she said, referring to Brewer Lane?s criticism of the report. Brewer Lane, the ex-girlfriend whose first run-in with Donald Trump was used as the lead anecdote for the article, titled ?Crossing the Line: How Donald Trump Behaved With Women in Private,? accused the newspaper of putting a negative connotation on her words.\n?Most of the time when stories are inaccurate they?re not discredited, and I will be frustrated by that, but in this case I think they went so far,? Ivanka Trump continued. ?They had such a strong thesis and created facts to reinforce it and, you know, I think that narrative has been playing out now and there?s backlash in that regard.?\nSource RealTimePolitics.com Check out more contributions by Jeffery Pritchett ranging from UFO to Bigfoot to Paranormal to Prophecy".replace('\n', '')
#fake = "Report Copyright Violation World's Oldest Person Had Smoked For 76 Years actually, i think i remember a few of these people over the years who had hit significant milestones had had at least some 'bad' habits, such as smoking or drinking (but probably not to excess). Guess it depends on the person.World's oldest person turns 115Aug. 22, 2006. 05:30 AMASSOCIATED PRESSISABELA, Puerto Rico ? The world's oldest person celebrated his 115th birthday Monday, offering advice on healthy living at a party where he was serenaded by a well-known Puerto Rican singer.Emiliano Mercado del Toro, who was a boy when the United States seized Puerto Rico from Spain in 1898, attributed his long life to a healthy diet and avoiding alcohol.\"I never damaged my body with liquor,\" said Mercado, who quit a 76-year smoking habit when he was 90.Mercado was declared the world's oldest person by the Guinness Book of Records last year.\"I never thought I would last so long,\" he said.An ambulance carried him to an outdoor plaza where family, friends and the mayor gathered for the party. His favourite performer, Iris Chacon, crooned a birthday tune set to mariachi music.\"I feel happy,\" said the wheelchair-bound Mercado, who has difficulty hearing and has been blind for four years. He lives with a niece in the northwestern coastal town of Isabela.Mercado was recruited into the U.S. army in 1918, during the last months of the First World War. He was still in training when the war ended in November of that year.As a young man, Mercado said he worked for 50 cents US a day driving animals loaded with sugar cane to processing centres.The mayor of Isabela, Charlie Delgado, said a residence for the elderly would be named for Mercado in honour of a man who \"ate healthy, had no major vices and who has put this island on the world stage.\"Guinness had recognized another Puerto Rican as being the world's oldest person. Ramona Trinidad Iglesias Jordan died May 29, 2004, after a bout with pneumonia. She was 114.Get great home delivery subscription deals here! Anonymous Coward ( OP )".replace('\n', '')
#fake = "We Are Change \nDonald Trump on Saturday was quickly ushered off the stage by Secret Service agents in the middle of a campaign speech in Nevada after an incident in the crowd near the front of the stage.\nSecret Service rushes Trump off stage at Reno rally https://t.co/n82d9jXopX \n? Chrissy (@omgitsmechrissy) November 6, 2016 \nVideo shows that Trump was in the middle of his speech when the incident occurred. He was looking into the crowd, his hand over his eyes to block the glare from the stage lights, when Secret Service agents grabbed him and escorted him off the stage. Trump ducked his head as he left the stage. The crowd panicked with frightened looks on their faces, as the Secret Service and police tactical units rushed in to quickly arrest the man. Video on twitter shows the moment that the Secret Service and law enforcement took down the man. Got footage of man who was detained by police and Secret Service after @realDonaldTrump was rushed off stage by USSS agents pic.twitter.com/FVEieSYj5w \n? Jeremy Diamond (@JDiamond1) November 6, 2016 \nEarly unconfirmed reports suggest a man was armed in the crowd according to some witnesses. One witness said that they were in the crowd when an unknown guy creeped toward the stage staring at Trump. The witness then proceeded to get the attention of four bigger guys surrounding them and confronted the man. The man then freaked out and reached into his pocket to grab what looked like a gun.? According to the witness the man was mumbling about ?the delegates.? ? I was in the crowd, me and my dad saw a guy creeping toward the stage staring at trump. i got the attention of 4 big guys around me and we confronted him and when we did he spurged out and reached into his pocket to grab what looked like a gun. when we tackled him to the ground and between punches he kept saying something about ?the delegates?? he must have the delegates. sorry i?m pretty shaken up right now. ? With one person in the crowd shouting ?he?s got a gun.? The man was then detained by police officers, Secret Service agents and SWAT armed with assault rifles and taken to a side room for questioning. The suspect is seen below. Trump returned to the stage minutes later and proceeded to continue his speech before thanking the Secret Service and police. ?Nobody said it was going to be easy for us, but we will never be stopped. We will never be stopped. I want to thank the Secret Service. These guys are fantastic.? \n~Donald Trump, said.\nLuke breaks down the details in the video below of the attempted assassination of the anti-establishment candidate Donald Trump.\nIt?s worth noting that the last Trump assassination attempt also occurred in Nevada when Michael Sandford a British citizen attempted to grab a police officer?s gun and shoot Donald Trump a few weeks ago.\nJulian Assange was right when he said earlier today to John Pilger that ?anti-establishment Trump Wouldn?t Be Allowed To Win.? Although Julian just missed how he would be stopped.\n(THIS IS A DEVELOPING STORY AND WILL BE UPDATED AS NEW DETAILS BECOME AVAILABLE.) The post #BREAKING: SECOND Assassination Attempt On Trump In NV; Suspect Detained (LIVE BLOG) appeared first on We Are Change .".replace('\n', '')
fake = "Thursday, 27 October 2016 Biden and Trump to Duel \nSeeking to duplicate, if not surpass, the famous duel between Vice President Aaron Burr and Treasury Secretary Alexander Hamilton, Republican candidate for president, Donald Trump, and Vice President Joe Biden, agreed to fight a pistol duel. Although details of the duel have yet to be finalized, Amiko Aventurista, reports the duel will likely take place on the eve of the election. \nThree independent sources confirmed negotiations over broadcast rights are extremely tense. Trump demands the duel be the inaugural show of his new venture, Trump TV. \"It was my idea. I was the one who said I could shot someone on Fifth Avenue and my supporters would be with me. Other than Hilary, Obama, Rubio, Cruz, Jeb Bush, and a ton of others, I can think of no one better to shot than hair plug Joe. I'm the greatest shooter ever. A real sniper.\" \nBiden insist MSNBC must be the broadcaster because its liberal and minority audience wants to see Trump with several gun shots. In a response to Trump, Biden said, \"There is no way I can miss. His hair glows bright orange. All I have to do is point toward the glow\". \nMegan Kelly of Fox says Fox must host the show because she wants to see \"blood\" coming everywhere out of Trump just like he said blood was coming out of her. CNN's Wolf Blitzer decline to comment. Even ESPN is making a play for the event, pointing out it regularly shows non-traditional sporting events, such as bull riding, cross bow, and bowling. \nBoth sides agree Lin Manuel Mirada, producer of the hit Broadway show, Alexander Hamilton, should direct the event. Manuel Mirada said, \"I would be honored to produce the event. I know my smash Broadway hit, Hamilton, is only a show about a duel not a real duet but I think that experience qualifies me to produce a show about a real duel. After all, the only difference is the guns are real.\" \nThe National Rifle Association (NRA) has agreed to fully pay for and sponsor the event. NRA President Wayne LaPierre release the following statement, \"Finally we have bi-partisan agreement. I should have thought of this first\". Make Amiko Aventurista's".replace('\n', '')

vector1 = text_to_vector(fake)
#vector2 = text_to_vector(text2)

with open(RealJson_notiziaAggiunta,'r') as dataset:
    for line in dataset:
        article = ast.literal_eval(line)
        text2 = article['text']
        vector2 = text_to_vector(text2)
        cosine = get_cosine(vector1, vector2)
        cosineSimDict[conta] = cosine
        conta+=1
        print 'Cosine:', cosine

sortedCosine = sorted(cosineSimDict.items(), key=lambda x: x[1])
sortedCosine.reverse()
print sortedCosine
#print 'Cosine:', cosine
maxSim = sortedCosine[0][0]
with open(RealJson_notiziaAggiunta,'r') as dataset:
    for line in dataset:
        if contatore == maxSim:
            article = ast.literal_eval(line)
            realnewsfinded = article['text'].replace('\n', '')
        contatore+=1

print("Fake news inserita: \n")
print(fake)
print("\n Real news corrispondente: \n")
print(realnewsfinded)